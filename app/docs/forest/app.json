[{"name":"app.R","content":"library(shiny);\n\n# Define UI for application that draws a histogram\nui <- fluidPage(\n\n    # Application title\n    titlePanel(\"An intuitive understanding of mean and standard deviation\"),\n    \n    hr(),\n    h4(\"Use the sliders at the bottom to change the mean and standard deviation of tree heights in the forest\"),\n    hr(),\n    \n    plotOutput(\"distPlot\"),\n    \n    fluidRow(\n        column(4, offset = 1,\n               sliderInput(\"Mean\", label = \"Mean\", width=\"100%\", min = 10, \n                           max = 25, value = 15, step = 1), \n        ),\n        column(1, offset = 0),\n        column(4, offset = 1,\n            sliderInput(\"SD\", label = \"Standard Deviation (SD)\", width=\"100%\",\n                        min = 0, max = 4, value = 0, step = 0.25)\n        )\n    )\n\n)\n\n# Define server logic required to draw a histogram\nserver <- function(input, output) {\n\n    mbox <- function(x0, x1, y0, y1){\n        xx <- seq(from=x0, to=x1, length.out = 100);\n        yy <- seq(from=y0, to=y1, length.out = 100);\n        xd <- c(rep(x0, 100), xx, rep(x1,100), rev(xx));\n        yd <- c(yy, rep(y1,100), rev(yy), rep(y0, 100));\n        return(list(x=xd, y=yd));\n    }\n    \n    build_land <- function(top = 30, ground = 2){\n        par(mar = c(0, 0, 0, 0), oma = c(0, 0, 0, 0));\n        plot(x = 0, y = 0, type = \"n\", xlim = c(0, 100), ylim = c(0, top),\n             xlab = \"\", ylab = \"\", xaxt = \"n\", yaxt = \"n\");\n        grass <- mbox(x0 = 0, x1 = 100, y0 = 0, y1 = ground);\n        sky   <- mbox(x0 = 0, x1 = 100, y0 = ground, y1 = 300);\n        polygon(x = grass$x, y = grass$y, col = \"lightgreen\", lwd = 0.01);\n        polygon(x = sky$x, y = sky$y, col = \"lightblue\", lwd = 0.01);\n    }\n\n    \n    tree <- function(loc, height){\n        radiu <- height * 0.05;\n        trunk <- mbox(x0 = loc - radiu, x1 = loc + radiu, y0 = 0, y1 = height);\n        polygon(x = trunk$x, y = trunk$y, lwd = 1, col = \"brown\");\n        points(x = loc, y = height, pch = 21, cex = radiu*8, bg = \"darkgreen\");\n    }\n    \n    trees <- function(n, mean, sd){\n        tr  <- seq(from = 10, to = 90, length = n);\n        hgt <- rnorm(n = n, mean = mean, sd = sd);\n        hgt[hgt < 0.25] <- 0.25;\n        for(i in 1:n){\n            tree(loc = tr[i], height = hgt[i]);\n        } \n    }\n    \n    forest <- function(n = 15, mean, sd){\n        build_land();\n        trees(n = n, mean = mean, sd = sd);\n    }\n    \n    output$distPlot <- renderPlot({\n        Mn  <- as.numeric(input$Mean);\n        Sd  <- as.numeric(input$SD);\n        forest(mean = Mn, sd = Sd);\n    })\n}\n\n# Run the application \nshinyApp(ui = ui, server = server)\n","type":"text"}]
